name: Build and Deploy VuePress Site

on: [push]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      # Check out the repository
      - name: Check out repository
        uses: actions/checkout@v2

      # Install VuePress
      - name: Install VuePress
        run: npm install -D vuepress@next && npm i @vuepress/cli && npm install -g vuepress

      # # Create a VuePress site
      # - name: Create VuePress site
      #   run: vuepress init docs

      # Install necessary packages
      - name: Install necessary packages
        run: npm i stylus && npm i vuepress-plugin-md-enhance && npm i vuepress-theme-bcc-common-components && npm i tailwindcss

      # Setup the right theme config.
      - name: List folders
        run: |
          ls

      - name: Check if docs / .vuepress exists
        run: cd docs

      - name: List folders
        run: |
          ls

      - name: Check if docs / .vuepress exists
        run: cd .vuepress

      - name: Inject config into config.js file
        run:  |
          echo "const foo = 'bar';" >> config.js
          echo "console.log(foo);" >> config.js

      - name: Check the config file
        run: cat config.js

      # Build the VuePress site
      - name: Build VuePress site
        run: vuepress build docs

      # Deploy the built site as an asset to the repository
      - name: Deploy built site
        uses: actions/upload-artifact@v1
        with:
          name: vuepress-site
          path: docs/.vuepress/dist
